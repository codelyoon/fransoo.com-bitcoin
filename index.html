<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>fransoo.com | Finance Portal</title>
  <style>
    body {background:#000;color:#00bfff;font-family:'Courier New',monospace;margin:0;overflow:hidden;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative}
    #static-canvas {position:absolute;top:0;left:0;width:100%;height:100%;opacity:0.15;pointer-events:none;z-index:1}
    .container {z-index:2;text-align:center;max-width:900px;width:100%;padding:20px;box-sizing:border-box}
    .typing {font-size:20px;white-space:pre-line}
    .cursor {display:inline-block;width:10px;height:22px;background:#00bfff;animation:blink 1s infinite;vertical-align:middle}
    @keyframes blink {0%,50%{opacity:1}51%,100%{opacity:0}}
    #price-box {position:absolute;top:20px;right:20px;font-size:28px;font-weight:bold;letter-spacing:1px;z-index:3}
    .up {color:#00ff00}
    .down {color:#ff0044}
    #chart-container {margin-top:30px;width:100%;height:60vh;background:#000;border:1px solid #00bfff;position:relative}
    canvas#chart {width:100%;height:100%;display:block}
    #timeframe-select {position:absolute;top:12px;left:12px;z-index:3;background:#000;border:1px solid #00bfff;color:#00bfff;padding:8px 14px;font-size:15px;border-radius:4px}
  </style>
</head>
<body>
  <canvas id="static-canvas"></canvas>
  <div id="price-box">BTC $--.---</div>
  <div class="container">
    <div class="typing" id="typing"></div>
    <div id="chart-container">
      <select id="timeframe-select">
        <option value="1h">1H</option>
        <option value="1d" selected>1D</option>
        <option value="7d">7D</option>
        <option value="30d">30D</option>
        <option value="ytd">YTD</option>
        <option value="all">ALL</option>
      </select>
      <canvas id="chart"></canvas>
    </div>
  </div>

  <script>
    // Static noise
    const sc = document.getElementById('static-canvas');
    const sctx = sc.getContext('2d');
    sc.width = innerWidth; sc.height = innerHeight;
    window.addEventListener('resize',()=>{sc.width=innerWidth;sc.height=innerHeight});
    (function noise(){const d=sctx.createImageData(sc.width,sc.height);const b=new Uint32Array(d.data.buffer);
      for(let i=0;i<b.length;i++)if(Math.random()<0.09)b[i]=0x33ffffff;sctx.putImageData(d,0,0);requestAnimationFrame(noise);})();

    const intro = `welcome to the fransoo.com finance portal

here's the live BTC chart & price`;
    const typingEl = document.getElementById('typing');
    function type(t,e,cb){let i=0;const x=setInterval(()=>{if(i<t.length){e.innerHTML+=t[i]==='\n'?'<br>':t[i];i++}else{clearInterval(x);cb&&cb()}},45);}
    type(intro, typingEl, () => typingEl.innerHTML += '<span class="cursor"></span>');

    const canvas = document.getElementById('chart');
    const ctx = canvas.getContext('2d');
    const priceBox = document.getElementById('price-box');
    const select = document.getElementById('timeframe-select');

    function resize() {
      canvas.width = canvas.offsetWidth * devicePixelRatio;
      canvas.height = canvas.offsetHeight * devicePixelRatio;
      ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, 0, 0);
    }
    window.addEventListener('resize', resize);
    resize();

    async function updatePrice() {
      const r = await fetch('https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT');
      const d = await r.json();
      const p = parseFloat(d.lastPrice);
      const c = parseFloat(d.priceChangePercent);
      priceBox.innerHTML = `BTC $${p.toLocaleString('en-US',{minimumFractionDigits:0,maximumFractionDigits:0})} 
        <span class="${c>=0?'up':'down'}">${c>=0?'Up':'Down'}${Math.abs(c).toFixed(2)}%</span>`;
    }

    async function loadChart(tf) {
      let interval, limit;
      if (tf==='1h')   { interval='1m'; limit=60; }
      if (tf==='1d')   { interval='1h'; limit=25; }
      if (tf==='7d')   { interval='4h'; limit=42; }
      if (tf==='30d')  { interval='1d'; limit=30; }
      if (tf==='ytd')  { interval='1d'; limit=365; }
      if (tf==='all')  { interval='1d'; limit=2500; }

      const r = await fetch(`https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=${interval}&limit=${limit}`);
      const klines = await r.json();

      const prices = klines.map(k => parseFloat(k[4])); // close
      const timestamps = klines.map(k => new Date(k[0]));

      drawChart(prices, timestamps, tf);
    }

    function drawChart(prices, times, tf) {
      resize();
      const w = canvas.width / devicePixelRatio;
      const h = canvas.height / devicePixelRatio;
      ctx.clearRect(0,0,w,h);

      const pad = 60;
      const cw = w - 2*pad;
      const ch = h - 2*pad;

      const maxP = Math.max(...prices);
      const minP = Math.min(...prices);
      const range = maxP - minP || 1;

      // Fill area
      ctx.fillStyle = 'rgba(0,191,255,0.1)';
      ctx.beginPath();
      prices.forEach((p,i) => {
        const x = pad + (i/(prices.length-1)) * cw;
        const y = h - pad - ((p - minP)/range) * ch;
        i===0 ? ctx.moveTo(x,y) : ctx.lineTo(x,y);
      });
      ctx.lineTo(w-pad, h-pad);
      ctx.lineTo(pad, h-pad);
      ctx.closePath();
      ctx.fill();

      // Line
      ctx.strokeStyle = '#00bfff';
      ctx.lineWidth = 2.2;
      ctx.beginPath();
      prices.forEach((p,i) => {
        const x = pad + (i/(prices.length-1)) * cw;
        const y = h - pad - ((p - minP)/range) * ch;
        i===0 ? ctx.moveTo(x,y) : ctx.lineTo(x,y);
      });
      ctx.stroke();

      // Horizontal grid + Y labels
      ctx.strokeStyle = '#003340';
      ctx.lineWidth = 1;
      ctx.fillStyle = '#00bfff';
      ctx.font = '14px monospace';
      ctx.textAlign = 'right';
      for(let i=0;i<=4;i++){
        const y = pad + i*(ch/4);
        ctx.beginPath(); ctx.moveTo(pad,y); ctx.lineTo(w-pad,y); ctx.stroke();
        const val = maxP - i*(range/4);
        ctx.fillText(`$${val.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")}`, w-pad-8, y+5);
      }

      // X-axis labels â€” REAL time that makes sense
      ctx.textAlign = 'center';
      const steps = 5;
      for(let i=0;i<=steps;i++){
        const idx = Math.round(i * (prices.length-1) / steps);
        const x = pad + idx * cw / (prices.length-1);
        const t = times[idx];

        let label;
        if (tf==='1h')   label = idx===0 ? 'now' : `${60-Math.round(idx)}m`;
        else if (tf==='1d')  label = idx===0 ? 'now' : `${24-idx}h`;
        else if (tf==='7d')  label = idx===0 ? 'now' : `${7-Math.round(idx/10.5)}D`;
        else if (tf==='30d') label = idx===0 ? 'now' : `${30-Math.round(idx)}D`;
        else if (tf==='ytd' || tf==='all') {
          label = t.toLocaleDateString('en-US', tf==='all' ? {year:'numeric'} : {month:'short', day:'numeric'});
        }

        ctx.fillText(label, x, h-pad+22);
      }

      // Border
      ctx.strokeStyle = '#00bfff';
      ctx.lineWidth = 1.5;
      ctx.strokeRect(pad, pad, cw, ch);
    }

    select.addEventListener('change', () => loadChart(select.value));
    updatePrice();
    loadChart('1d');
    setInterval(()=>{ updatePrice(); loadChart(select.value); }, 30000);
  </script>
</body>
</html>
